<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Menu | Yelp Somalia</title>
    <link rel="icon" type="image/png" sizes="32x32" href="/Assets/Logo.png">
    <!-- Base styles (header/footer) -->
    <link rel="stylesheet" href="/Styles/index.css">
    <link rel="stylesheet" href="/Styles/socials.css"> <!-- If needed for footer -->
    <!-- Specific styles for this page -->
    <link rel="stylesheet" href="/Styles/menu-editor.css"> <!-- We'll create this -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header>
        <!-- Your standard header HTML from business-detail.html -->
        <div class="navbar">
            <a href="/index.html" class="logo"><i class="fas fa-arrow-left"></i></a>
            <!-- <a href="#" class="logo">Yelp <span>Somalia</span> | Business</a> -->
        </div>
    </header>

    <main class="menu-editor-container">
        <div id="loading-editor" class="loading-message">
            <div class="loading-spinner"></div>
            <p>Loading menu editor...</p>
        </div>
        <div id="editor-error" class="error-message" style="display: none;"></div>
        <div id="editor-auth-prompt" class="auth-prompt" style="display: none;">
            <p>You must be logged in as the business owner to manage this menu.</p>
            <p>Please <button type="button" class="link-button" id="editor-login-prompt-button">log in</button>.</p>
            <!-- Or, if they are logged in but not the owner of THIS businessId: -->
            <!-- <p>You do not have permission to edit this menu.</p> -->
        </div>

        <div id="menu-editor-content" style="display: none;">
            <h1 id="menu-editor-business-name">Manage Menu for [Business Name]</h1>
            <p id="menu-editor-status" class="status-message"></p>

            <!-- Add New Section Form -->
            <section class="menu-section-form-container">
                <h3>Add New Menu Section</h3>
                <form id="add-section-form">
                    <div class="form-group">
                        <label for="section-name">Section Name:</label>
                        <input type="text" id="section-name" required placeholder="e.g., Breakfast, Main Courses, Drinks">
                    </div>
                    <div class="form-group">
                        <label for="section-order">Display Order (optional, lower numbers first):</label>
                        <input type="number" id="section-order" placeholder="e.g., 1">
                    </div>
                    <button type="submit" class="btn btn-primary">Add Section</button>
                </form>
            </section>

            <!-- Display Existing Sections and Items -->
            <section class="menu-sections-display">
                <h2>Current Menu Sections</h2>
                <div id="sections-list">
                    <!-- Sections and items will be dynamically inserted here by JS -->
                    <!-- Example of how one section might look (generated by JS):
                    <div class="menu-section" data-section-id="sec123">
                        <div class="section-header">
                            <h3 class="section-title-display">Breakfast</h3>
                            <input type="text" class="section-title-edit" value="Breakfast" style="display:none;">
                            <input type="number" class="section-order-edit" value="1" style="display:none;">
                            <div class="section-actions">
                                <button class="btn-edit-section">Edit</button>
                                <button class="btn-save-section" style="display:none;">Save</button>
                                <button class="btn-cancel-edit-section" style="display:none;">Cancel</button>
                                <button class="btn-delete-section">Delete Section</button>
                            </div>
                        </div>
                        <div class="menu-items-list">
                            <p>No items in this section yet.</p>
                        </div>
                        <div class="add-item-to-section-area">
                            <button class="btn-show-add-item-form">+ Add Item to this Section</button>
                            <form class="add-item-form" style="display:none;">
                                <h4>Add New Item to [Section Name]</h4>
                                <input type="text" name="itemName" placeholder="Item Name (e.g., Coffee)" required>
                                <textarea name="itemDescription" placeholder="Description (optional)"></textarea>
                                <input type="number" name="itemPrice" placeholder="Price (e.g., 2.50)" step="0.01" required>
                                <input type="number" name="itemOrder" placeholder="Display Order (optional)">
                                <label>Item Image (optional, max 1.5MB):</label>
                                <input type="file" name="itemImage" accept="image/png, image/jpeg, image/gif, image/webp">
                                <img class="item-image-preview" src="#" alt="Preview" style="display:none; max-width:100px; margin-top:5px;">
                                
                                <div class="item-form-actions">
                                    <button type="submit">Save Item</button>
                                    <button type="button" class="btn-cancel-add-item">Cancel</button>
                                </div>
                                <p class="item-form-status error-message"></p>
                            </form>
                        </div>
                    </div>
                    -->
                </div>
            </section>
        </div>
    </main>

    <footer><!-- Your standard footer --></footer>
    <!-- ============================================= -->
    <!-- ===== NEW EDIT ITEM MODAL =================== -->
    <!-- ============================================= -->
    <div id="edit-item-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3 id="edit-item-modal-title">Edit Menu Item</h3>
            <form id="edit-item-form">
                <!-- This hidden input will store the ID of the item we're editing -->
                <input type="hidden" id="edit-item-id">
                
                <div class="form-group">
                    <label for="edit-item-name">Item Name:</label>
                    <input type="text" id="edit-item-name" required>
                </div>
                <div class="form-group">
                    <label for="edit-item-description">Description:</label>
                    <textarea id="edit-item-description"></textarea>
                </div>
                <div class="form-group">
                    <label for="edit-item-price">Base Price:</label>
                    <input type="number" id="edit-item-price" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="edit-item-order">Display Order:</label>
                    <input type="number" id="edit-item-order">
                </div>
                <div class="form-group">
                    <label>Item Image:</label>
                    <input type="file" id="edit-item-image-upload" accept="image/png, image/jpeg, image/gif, image/webp">
                    <img id="edit-item-image-preview" src="#" alt="Preview" style="display:none;">
                </div>

                <!-- Manage Extras Section (re-used from the add form) -->
                <div class="manage-extras-container">
                    <h4>Manage Extras / Options</h4>
                    <div class="add-extra-form">
                        <input type="text" id="edit-extra-name" placeholder="Extra Name">
                        <input type="number" id="edit-extra-price" placeholder="Price" step="0.01">
                        <button type="button" id="edit-btn-add-extra" class="btn btn-secondary btn-small">Add Extra</button>
                    </div>
                    <div id="edit-extras-list" class="extras-list">
                        <!-- List of existing extras will be shown here -->
                    </div>
                </div>

                <div class="modal-form-actions">
                    <button type="button" id="edit-item-cancel-btn" class="btn btn-secondary">Cancel</button>
                    <button type="submit" id="edit-item-save-btn" class="btn btn-primary">Save Changes</button>
                </div>
                <p id="edit-item-status" class="form-message"></p>
            </form>
        </div>
    </div>


    <!-- Firebase and Auth Scripts (same as business-detail.html) -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    <script type="module" src="/firebase-config/indexfirebaseConfig.js"></script>
    <script type="module" src="/js/auth.js"></script>

    <!-- Specific JS for this page -->
    <script type="module" src="/js/menu-editor.js"></script>
</body>
</html>
